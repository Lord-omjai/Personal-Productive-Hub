<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Personal Productivity Hub - Manage tasks, habits, notes and expenses in one place">
  <meta name="keywords" content="productivity, todo list, habit tracker, notes, expense tracker">
  <meta name="author" content="Personal Productivity Hub">
  <title>Personal Productivity Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>
  <style>
    :root {
      --bg-color: #f9f9f9;
      --text-color: #222;
      --card-bg: #fff;
      --accent-color: #3498db;
      --accent-light: #5dade2;
      --accent-dark: #2874a6;
      --shadow: rgba(0, 0, 0, 0.15);
      --success: #2ecc71;
      --error: #e74c3c;
      --warning: #f39c12;
      --transition: all 0.3s ease;
    }

    body {
      font-family: 'Poppins', sans-serif;
      line-height: 1.6;
      letter-spacing: 0.02em;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4e7f1 100%);
      color: var(--text-color);
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    body.dark {
      --bg-color: #1a1a2e;
      --text-color: #e6e6e6;
      --card-bg: #16213e;
      --accent-color: #2980b9;
      --accent-light: #3498db;
      --accent-dark: #1a5276;
      --shadow: rgba(0, 0, 0, 0.6);
      background: linear-gradient(135deg, #0f0c29 0%, #302b63 100%);
    }

    /* Animated background elements */
    .bg-bubble {
      position: fixed;
      border-radius: 50%;
      background: rgba(52, 152, 219, 0.1);
      z-index: -1;
      animation: float 15s infinite ease-in-out;
    }

    @keyframes float {
      0%, 100% { transform: translate(0, 0); }
      25% { transform: translate(-10px, -15px); }
      50% { transform: translate(5px, 5px); }
      75% { transform: translate(10px, -10px); }
    }

    .bubble-1 {
      width: 200px;
      height: 200px;
      top: 10%;
      left: 5%;
      animation-duration: 20s;
    }

    .bubble-2 {
      width: 150px;
      height: 150px;
      bottom: 15%;
      right: 10%;
      animation-duration: 18s;
      animation-delay: 2s;
    }

    .bubble-3 {
      width: 100px;
      height: 100px;
      top: 40%;
      right: 20%;
      animation-duration: 22s;
      animation-delay: 4s;
    }

    /* Header */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      animation: slideDown 0.6s ease-out;
    }

    @keyframes slideDown {
      from {
        transform: translateY(-100px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    header h1 {
      margin: 0;
      font-weight: 700;
      font-size: 1.8rem;
      background: linear-gradient(90deg, var(--accent-color), var(--accent-light));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Navigation */
    nav {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 2rem;
      justify-content: center;
      animation: fadeIn 0.8s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    nav button {
      background: var(--card-bg);
      border: none;
      padding: 0.8rem 1.5rem;
      cursor: pointer;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: var(--transition);
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    nav button i {
      font-size: 1.2rem;
    }

    nav button.active,
    nav button:hover {
      background: linear-gradient(135deg, var(--accent-color), var(--accent-light));
      color: white;
      box-shadow: 0 6px 15px var(--shadow);
      transform: translateY(-3px);
    }

    /* Sections */
    .app-section {
      border-radius: 16px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.12);
      padding: 1.5rem;
      background: var(--card-bg);
      color: var(--text-color);
      margin-bottom: 2rem;
      transition: all 0.4s ease-in-out;
      opacity: 1;
      transform: translateY(0);
      animation: sectionAppear 0.5s ease-out;
    }

    @keyframes sectionAppear {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .app-section.hidden {
      opacity: 0;
      pointer-events: none;
      position: absolute;
      left: -9999px;
      transform: translateY(20px);
    }

    .app-section h2 {
      margin-top: 0;
      margin-bottom: 1.5rem;
      padding-bottom: 0.8rem;
      border-bottom: 2px solid var(--accent-color);
      font-size: 1.5rem;
      color: var(--accent-color);
    }

    /* Form elements */
    .input-group {
      display: flex;
      gap: 10px;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .input-group input, 
    .input-group textarea, 
    .input-group select {
      flex: 1;
      min-width: 200px;
    }

    input[type="text"],
    input[type="number"],
    input[type="password"],
    textarea,
    select {
      border-radius: 10px;
      border: 2px solid #e0e0e0;
      padding: 0.9rem 1.2rem;
      font-size: 1rem;
      transition: var(--transition);
      background: var(--bg-color);
      color: var(--text-color);
    }

    body.dark input[type="text"],
    body.dark input[type="number"],
    body.dark input[type="password"],
    body.dark textarea,
    body.dark select {
      border-color: #2c3e50;
    }

    input[type="text"]:focus,
    input[type="number"]:focus,
    input[type="password"]:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
    }

    button {
      font-weight: 600;
      border-radius: 10px;
      padding: 0.9rem 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: var(--transition);
      user-select: none;
      border: none;
      background: linear-gradient(135deg, var(--accent-color), var(--accent-light));
      color: white;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    button:hover {
      background: linear-gradient(135deg, var(--accent-dark), var(--accent-color));
      box-shadow: 0 6px 15px var(--shadow);
      transform: translateY(-3px);
    }

    button.secondary {
      background: transparent;
      border: 2px solid var(--accent-color);
      color: var(--accent-color);
    }

    button.secondary:hover {
      background: var(--accent-color);
      color: white;
    }

    /* Lists */
    ul {
      list-style: none;
      padding: 0;
      margin: 1.5rem 0 0 0;
    }

    li {
      background: var(--bg-color);
      margin-bottom: 0.8rem;
      padding: 1rem;
      border-radius: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      transition: var(--transition);
      animation: listItemAppear 0.3s ease-out;
    }

    @keyframes listItemAppear {
      from {
        opacity: 0;
        transform: translateX(-10px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    li:hover {
      box-shadow: 0 6px 15px rgba(0,0,0,0.15);
      transform: translateY(-3px);
    }

    .list-actions {
      display: flex;
      gap: 8px;
    }

    .list-actions button {
      padding: 0.5rem;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Lock screen */
    .lock-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(10, 10, 20, 0.95);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      backdrop-filter: blur(5px);
    }

    .lock-box {
      background: var(--card-bg);
      padding: 2.5rem;
      border-radius: 16px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.3);
      text-align: center;
      max-width: 400px;
      width: 90%;
      animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    @keyframes popIn {
      0% {
        transform: scale(0.8);
        opacity: 0;
      }
      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    .lock-box h2 {
      margin-top: 0;
      margin-bottom: 1.5rem;
      color: var(--accent-color);
    }

    .lock-box input {
      width: 100%;
      padding: 1rem;
      font-size: 1rem;
      margin: 1.5rem 0;
      border: 2px solid #888;
      border-radius: 10px;
      background: var(--bg-color);
      color: var(--text-color);
      text-align: center;
      font-size: 1.2rem;
    }

    .lock-box button {
      width: 100%;
      padding: 1rem;
      font-size: 1.1rem;
      border-radius: 10px;
    }

    .lock-message {
      color: var(--error);
      margin-top: 1rem;
      height: 1.5rem;
      font-weight: 500;
    }

    /* Settings */
    .setting-item {
      margin: 1.5rem 0;
      max-width: 500px;
      padding: 1rem;
      border-radius: 10px;
      background: var(--bg-color);
    }

    .setting-item label {
      display: block;
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: var(--accent-color);
    }

    .setting-item input[type="checkbox"] {
      transform: scale(1.5);
      margin-left: 10px;
      vertical-align: middle;
      cursor: pointer;
    }

    /* Ad containers */
    .ad-container {
      margin: 2rem auto;
      text-align: center;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 20px;
      max-width: 728px;
    }

    .ad-label {
      font-size: 0.9rem;
      color: #888;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .ad-placeholder {
      width: 100%;
      height: 90px;
      background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #888;
      font-weight: 600;
      margin: 0 auto;
    }

    body.dark .ad-placeholder {
      background: linear-gradient(45deg, #2c3e50, #34495e);
      color: #aaa;
    }

    /* Help section */
    .help-content {
      max-width: 700px;
      line-height: 1.6;
      background: var(--bg-color);
      padding: 1.5rem;
      border-radius: 12px;
    }

    .help-content h3 {
      margin-top: 1.5rem;
      margin-bottom: 0.8rem;
      color: var(--accent-color);
    }

    .help-content ul {
      list-style-type: disc;
      padding-left: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .help-content li {
      background: transparent;
      box-shadow: none;
      padding: 0.3rem 0;
      margin: 0;
      animation: none;
    }

    /* Floating Help */
    #helpToggle {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: linear-gradient(135deg, var(--accent-color), var(--accent-light));
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 1.8rem;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      transition: var(--transition);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #helpToggle:hover {
      transform: scale(1.1) rotate(10deg);
      box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    }

    .help-tooltip {
      position: fixed;
      bottom: 105px;
      right: 30px;
      width: 300px;
      background: var(--card-bg);
      box-shadow: 0 15px 35px rgba(0,0,0,0.2);
      border-radius: 16px;
      padding: 1.5rem;
      color: var(--text-color);
      font-size: 0.95rem;
      z-index: 1000;
      animation: tooltipAppear 0.3s ease-out;
    }

    @keyframes tooltipAppear {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .help-tooltip h3 {
      margin-top: 0;
      margin-bottom: 1rem;
      color: var(--accent-color);
    }

    .help-tooltip ul {
      padding-left: 1.2rem;
      margin: 0;
    }

    .help-tooltip li {
      background: transparent;
      padding: 0.3rem 0;
      margin: 0;
      box-shadow: none;
    }

    .help-tooltip button {
      margin-top: 1rem;
      padding: 0.6rem 1.2rem;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }
      
      nav {
        flex-direction: column;
      }
      
      .input-group {
        flex-direction: column;
      }
      
      .ad-container {
        padding: 15px;
      }
      
      .ad-placeholder {
        height: 100px;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 0.8rem;
      }
      
      header h1 {
        font-size: 1.5rem;
      }
      
      .app-section {
        padding: 1.2rem;
      }
      
      .lock-box {
        padding: 1.5rem;
      }
      
      .help-tooltip {
        width: 280px;
        right: 15px;
      }
      
      #helpToggle {
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
      }
    }

    /* Stats and progress */
    .stats-container {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      margin: 1.5rem 0;
    }

    .stat-card {
      flex: 1;
      min-width: 150px;
      background: var(--bg-color);
      border-radius: 12px;
      padding: 1.2rem;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent-color);
      margin: 0.5rem 0;
    }

    .stat-label {
      font-size: 0.9rem;
      color: #777;
    }

    /* Progress bars */
    .progress-container {
      margin: 1.5rem 0;
    }

    .progress-bar {
      height: 12px;
      background: #e0e0e0;
      border-radius: 6px;
      overflow: hidden;
      margin-top: 0.5rem;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent-color), var(--accent-light));
      border-radius: 6px;
      transition: width 0.8s cubic-bezier(0.22, 0.61, 0.36, 1);
    }

    /* Animations for UI elements */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .pulse {
      animation: pulse 2s infinite;
    }
  </style>
</head>
<body>
  <!-- Animated background elements -->
  <div class="bg-bubble bubble-1"></div>
  <div class="bg-bubble bubble-2"></div>
  <div class="bg-bubble bubble-3"></div>

  <!-- Password Lock Screen -->
  <div id="lockScreen" class="lock-screen">
    <div class="lock-box">
      <h2>Enter Password to Unlock</h2>
      <input type="password" id="passwordInput" placeholder="Password" autocomplete="off" />
      <button onclick="checkPassword()">Unlock</button>
      <p id="lockMessage" class="lock-message"></p>
    </div>
  </div>

  <header>
    <h1>Personal Productivity Hub</h1>
    <button id="themeToggle" onclick="toggleTheme()">üåô Dark Mode</button>
  </header>

  <!-- Ad Space - Top -->
  <div class="ad-container">
    <div class="ad-label">Advertisement</div>
    <div class="ad-placeholder">Google AdSense Banner (728x90)</div>
    <!-- 
      Actual AdSense code:
      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
               crossorigin="anonymous"></script>
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
           data-ad-slot="XXXXXXXXXX"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    -->
  </div>

  <nav>
    <button onclick="showSection('todo')"><i>üìù</i> To-Do</button>
    <button onclick="showSection('habit')"><i>‚úÖ</i> Habits</button>
    <button onclick="showSection('notes')"><i>üìì</i> Notes</button>
    <button onclick="showSection('expense')"><i>üí∞</i> Expenses</button>
    <button onclick="showSection('settings')"><i>‚öôÔ∏è</i> Settings</button>
    <button onclick="showSection('help')"><i>‚ùì</i> Help</button>
  </nav>

  <!-- Stats Overview -->
  <div class="stats-container">
    <div class="stat-card">
      <div class="stat-value" id="todoCount">0</div>
      <div class="stat-label">Tasks</div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="habitCount">0</div>
      <div class="stat-label">Habits</div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="noteCount">0</div>
      <div class="stat-label">Notes</div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="expenseTotal">‚Çπ0</div>
      <div class="stat-label">Expenses</div>
    </div>
  </div>

  <!-- Sections -->
  <section id="todo" class="app-section">
    <h2>To-Do List</h2>
    <div class="input-group">
      <input type="text" id="todoInput" placeholder="Add new task..." />
      <button onclick="addTodo()">Add Task</button>
    </div>
    <input type="text" id="todoSearch" placeholder="Search tasks..." />
    
    <div class="progress-container">
      <div>Task Completion: <span id="todoProgressValue">0%</span></div>
      <div class="progress-bar">
        <div class="progress-fill" id="todoProgressBar" style="width: 0%"></div>
      </div>
    </div>
    
    <ul id="todoList"></ul>
  </section>

  <section id="habit" class="app-section hidden">
    <h2>Habit Tracker</h2>
    <div class="input-group">
      <input type="text" id="habitInput" placeholder="Add new habit..." />
      <button onclick="addHabit()">Add Habit</button>
    </div>
    <input type="text" id="habitSearch" placeholder="Search habits..." />
    <ul id="habitList"></ul>
  </section>

  <section id="notes" class="app-section hidden">
    <h2>Notes / Diary</h2>
    <textarea id="noteText" rows="6" placeholder="Write your note here..."></textarea>
    <div class="input-group">
      <button onclick="saveNote()">Save Note</button>
      <button class="secondary" onclick="clearNote()">Clear</button>
    </div>
    <input type="text" id="noteSearch" placeholder="Search notes..." />
    <ul id="noteList"></ul>
  </section>

  <section id="expense" class="app-section hidden">
    <h2>Expense Tracker</h2>
    <div class="input-group">
      <input type="text" id="expenseTitle" placeholder="Expense title" />
      <input type="number" id="expenseAmount" placeholder="Amount" />
      <button onclick="addExpense()">Add Expense</button>
    </div>
    <ul id="expenseList"></ul>
  </section>

  <section id="settings" class="app-section hidden">
    <h2>Settings</h2>

    <div class="setting-item">
      <label for="passwordLockToggle">Enable Password Lock:</label>
      <input type="checkbox" id="passwordLockToggle" onchange="togglePasswordLock()" />
    </div>

    <div class="setting-item">
      <label for="themeSelect">Theme:</label>
      <select id="themeSelect" onchange="changeThemeFromSettings()">
        <option value="light">Light</option>
        <option value="dark">Dark</option>
      </select>
    </div>

    <div class="setting-item">
      <label for="currentPassword">Current Password:</label>
      <input type="password" id="currentPassword" placeholder="Enter current password" />
    </div>

    <div class="setting-item">
      <label for="newPassword">New Password:</label>
      <input type="password" id="newPassword" placeholder="Enter new password" />
    </div>

    <button onclick="changePassword()">Change Password</button>

    <p id="passwordChangeMessage"></p>
  </section>

  <section id="help" class="app-section hidden">
    <h2>Help & Guide</h2>
    <div class="help-content">
      <h3>App Shortcuts & Tips</h3>
      <ul>
        <li><strong>Enter</strong> ‚Äî Add To-Do or Expense</li>
        <li><strong>Ctrl + Enter</strong> ‚Äî Save Note (inside notes textarea)</li>
        <li><strong>Theme Toggle</strong> ‚Äî Switch between Dark and Light mode</li>
        <li><strong>Password Lock</strong> ‚Äî Secures your app at startup (can be enabled/disabled in Settings)</li>
        <li><strong>Search Boxes</strong> ‚Äî Quickly find tasks, habits, and notes</li>
        <li><strong>Settings</strong> ‚Äî Change password, theme, and app preferences</li>
      </ul>
      <h3>How to Use</h3>
      <p>Navigate through the menu to manage your To-Do lists, Habits, Notes, and Expenses.</p>
      <p>Track your productivity with the statistics dashboard at the top of the page.</p>
      <p>Use the Settings menu to customize the app according to your preferences.</p>
    </div>
  </section>

  <!-- Ad Space - Bottom -->
  <div class="ad-container">
    <div class="ad-label">Advertisement</div>
    <div class="ad-placeholder">Google AdSense Banner (728x90)</div>
  </div>

  <!-- Floating Help Tooltip -->
  <button id="helpToggle" title="Help Tips" aria-label="Help Tips">‚ùì</button>
  <div id="helpTooltip" class="help-tooltip hidden" role="dialog" aria-modal="true" aria-labelledby="helpTitle" tabindex="-1">
    <h3 id="helpTitle">Quick Tips</h3>
    <ul>
      <li>Press <strong>Enter</strong> to add To-Dos or Expenses.</li>
      <li>Use <strong>Ctrl + Enter</strong> to save Notes.</li>
      <li>Switch themes in Settings for Dark/Light mode.</li>
      <li>Enable password lock for app security.</li>
      <li>Use search boxes to find tasks quickly.</li>
    </ul>
    <button id="helpClose" aria-label="Close Help">Close</button>
  </div>

  <script>
    // Default password and keys for localStorage
    const DEFAULT_PASSWORD = "1234";
    const PASSWORD_KEY = "appPassword";
    const PASSWORD_LOCK_KEY = "passwordLockEnabled";

    // Initialize stored password if none
    if (!localStorage.getItem(PASSWORD_KEY)) {
      localStorage.setItem(PASSWORD_KEY, DEFAULT_PASSWORD);
    }

    // Sections show/hide logic with fade
    function showSection(sectionId) {
      const sections = document.querySelectorAll(".app-section");
      sections.forEach(section => {
        if (section.id === sectionId) {
          section.classList.remove("hidden");
          void section.offsetWidth; // reflow for transition
          section.style.opacity = 1;
          section.style.position = "static";
          section.style.left = "0";
        } else {
          section.style.opacity = 0;
          setTimeout(() => {
            section.classList.add("hidden");
            section.style.position = "absolute";
            section.style.left = "-9999px";
          }, 400);
        }
      });

      // Highlight active nav button
      const buttons = document.querySelectorAll("nav button");
      buttons.forEach(btn => {
        btn.classList.toggle(
          "active",
          btn.textContent.toLowerCase().includes(sectionId)
        );
      });
    }

    // Password Lock logic
    function checkPassword() {
      const lockEnabled = localStorage.getItem(PASSWORD_LOCK_KEY) === "true";
      const input = document.getElementById("passwordInput").value;
      const message = document.getElementById("lockMessage");
      const savedPwd = localStorage.getItem(PASSWORD_KEY);

      if (!lockEnabled) {
        document.getElementById("lockScreen").style.display = "none";
        return;
      }

      if (input === savedPwd) {
        document.getElementById("lockScreen").style.display = "none";
        message.textContent = "";
      } else {
        message.textContent = "Incorrect password, try again.";
      }
    }

    // On load, check if lock enabled
    window.onload = () => {
      if (localStorage.getItem(PASSWORD_LOCK_KEY) === "true") {
        document.getElementById("lockScreen").style.display = "flex";
      } else {
        document.getElementById("lockScreen").style.display = "none";
      }
      showSection("todo");
      loadTodos();
      loadHabits();
      loadNotes();
      loadExpenses();
      loadTheme();
      loadPasswordLockSetting();
      updateStats();
    };

    // Toggle password lock checkbox and save setting
    function togglePasswordLock() {
      const checked = document.getElementById("passwordLockToggle").checked;
      localStorage.setItem(PASSWORD_LOCK_KEY, checked);
    }

    // Load password lock setting checkbox state
    function loadPasswordLockSetting() {
      const checked = localStorage.getItem(PASSWORD_LOCK_KEY) === "true";
      document.getElementById("passwordLockToggle").checked = checked;
    }

    // Change password with validation and feedback
    function changePassword() {
      const currentPwdInput = document.getElementById("currentPassword").value;
      const newPwdInput = document.getElementById("newPassword").value;
      const message = document.getElementById("passwordChangeMessage");
      const savedPwd = localStorage.getItem(PASSWORD_KEY);

      if (!currentPwdInput || !newPwdInput) {
        message.textContent = "Please fill in both fields.";
        message.className = "message error";
        return;
      }
      if (currentPwdInput !== savedPwd) {
        message.textContent = "Current password is incorrect.";
        message.className = "message error";
        return;
      }
      localStorage.setItem(PASSWORD_KEY, newPwdInput);
      message.textContent = "Password changed successfully!";
      message.className = "message success";

      document.getElementById("currentPassword").value = "";
      document.getElementById("newPassword").value = "";
    }

    // Theme toggle and persistence
    function toggleTheme() {
      const body = document.body;
      body.classList.toggle("dark");
      const isDark = body.classList.contains("dark");
      localStorage.setItem("theme", isDark ? "dark" : "light");
      updateThemeButton(isDark);
      document.getElementById("themeSelect").value = isDark ? "dark" : "light";
    }

    function changeThemeFromSettings() {
      const select = document.getElementById("themeSelect");
      if (select.value === "dark") {
        document.body.classList.add("dark");
        updateThemeButton(true);
      } else {
        document.body.classList.remove("dark");
        updateThemeButton(false);
      }
      localStorage.setItem("theme", select.value);
    }

    function loadTheme() {
      const theme = localStorage.getItem("theme") || "light";
      if (theme === "dark") {
        document.body.classList.add("dark");
        updateThemeButton(true);
      } else {
        document.body.classList.remove("dark");
        updateThemeButton(false);
      }
      document.getElementById("themeSelect").value = theme;
    }

    function updateThemeButton(isDark) {
      const btn = document.getElementById("themeToggle");
      btn.textContent = isDark ? "‚òÄÔ∏è Light Mode" : "üåô Dark Mode";
    }

    // Stats update function
    function updateStats() {
      // To-Do stats
      const todos = JSON.parse(localStorage.getItem(TODO_STORAGE_KEY)) || [];
      document.getElementById("todoCount").textContent = todos.length;
      
      // Calculate completion percentage
      const completed = todos.filter(todo => todo.completed).length;
      const percentage = todos.length ? Math.round((completed / todos.length) * 100) : 0;
      document.getElementById("todoProgressValue").textContent = `${percentage}%`;
      document.getElementById("todoProgressBar").style.width = `${percentage}%`;
      
      // Habit stats
      const habits = JSON.parse(localStorage.getItem(HABIT_STORAGE_KEY)) || [];
      document.getElementById("habitCount").textContent = habits.length;
      
      // Note stats
      const notes = JSON.parse(localStorage.getItem(NOTES_STORAGE_KEY)) || [];
      document.getElementById("noteCount").textContent = notes.length;
      
      // Expense stats
      const expenses = JSON.parse(localStorage.getItem(EXPENSE_STORAGE_KEY)) || [];
      const total = expenses.reduce((sum, expense) => sum + expense.amount, 0);
      document.getElementById("expenseTotal").textContent = `‚Çπ${total.toFixed(2)}`;
    }

    // ---------------
    // To-Do List Logic
    // ---------------
    const TODO_STORAGE_KEY = "todos";

    function loadTodos() {
      const todos = JSON.parse(localStorage.getItem(TODO_STORAGE_KEY)) || [];
      const ul = document.getElementById("todoList");
      ul.innerHTML = "";
      todos.forEach((todo, index) => addTodoToDOM(todo, index));
      updateStats();
    }

    function saveTodos(todos) {
      localStorage.setItem(TODO_STORAGE_KEY, JSON.stringify(todos));
      updateStats();
    }

    function addTodo() {
      const input = document.getElementById("todoInput");
      const text = input.value.trim();
      if (text === "") return;
      
      const todo = {
        id: Date.now(),
        text: text,
        completed: false,
        createdAt: new Date().toISOString()
      };
      
      addTodoToDOM(todo);
      const todos = JSON.parse(localStorage.getItem(TODO_STORAGE_KEY)) || [];
      todos.push(todo);
      saveTodos(todos);
      input.value = "";
      input.focus();
      filterTodos();
    }

    function addTodoToDOM(todo, index) {
      const ul = document.getElementById("todoList");
      const li = document.createElement("li");
      li.dataset.id = todo.id;
      
      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.checked = todo.completed;
      checkbox.onchange = () => toggleTodoComplete(todo.id);
      
      const textSpan = document.createElement("span");
      textSpan.textContent = todo.text;
      textSpan.style.textDecoration = todo.completed ? "line-through" : "none";
      textSpan.style.opacity = todo.completed ? "0.7" : "1";
      
      const delBtn = document.createElement("button");
      delBtn.innerHTML = "‚ùå";
      delBtn.title = "Delete task";
      delBtn.className = "secondary";
      delBtn.onclick = () => deleteTodo(todo.id);
      
      li.appendChild(checkbox);
      li.appendChild(textSpan);
      li.appendChild(delBtn);
      ul.appendChild(li);
    }

    function toggleTodoComplete(id) {
      const todos = JSON.parse(localStorage.getItem(TODO_STORAGE_KEY)) || [];
      const todo = todos.find(t => t.id === id);
      if (todo) {
        todo.completed = !todo.completed;
        saveTodos(todos);
        loadTodos(); // Refresh the list
      }
    }

    function deleteTodo(id) {
      const todos = JSON.parse(localStorage.getItem(TODO_STORAGE_KEY)) || [];
      const newTodos = todos.filter(t => t.id !== id);
      saveTodos(newTodos);
    }

    function filterTodos() {
      const query = document.getElementById("todoSearch").value.toLowerCase();
      const items = document.querySelectorAll("#todoList li");
      items.forEach(item => {
        const text = item.querySelector("span").textContent.toLowerCase();
        item.style.display = text.includes(query) ? "" : "none";
      });
    }

    // Add To-Do with Enter key
    document.getElementById("todoInput").addEventListener("keyup", function(event) {
      if (event.key === "Enter") addTodo();
    });

    // ---------------
    // Habit Tracker Logic
    // ---------------
    const HABIT_STORAGE_KEY = "habits";

    function loadHabits() {
      const habits = JSON.parse(localStorage.getItem(HABIT_STORAGE_KEY)) || [];
      const ul = document.getElementById("habitList");
      ul.innerHTML = "";
      habits.forEach(habit => addHabitToDOM(habit));
      updateStats();
    }

    function saveHabits(habits) {
      localStorage.setItem(HABIT_STORAGE_KEY, JSON.stringify(habits));
      updateStats();
    }

    function addHabit() {
      const input = document.getElementById("habitInput");
      const text = input.value.trim();
      if (text === "") return;
      
      const habit = {
        id: Date.now(),
        text: text,
        createdAt: new Date().toISOString()
      };
      
      addHabitToDOM(habit);
      const habits = JSON.parse(localStorage.getItem(HABIT_STORAGE_KEY)) || [];
      habits.push(habit);
      saveHabits(habits);
      input.value = "";
      input.focus();
      filterHabits();
    }

    function addHabitToDOM(habit) {
      const ul = document.getElementById("habitList");
      const li = document.createElement("li");
      li.dataset.id = habit.id;
      
      const textSpan = document.createElement("span");
      textSpan.textContent = habit.text;
      
      const delBtn = document.createElement("button");
      delBtn.innerHTML = "‚ùå";
      delBtn.title = "Delete habit";
      delBtn.className = "secondary";
      delBtn.onclick = () => deleteHabit(habit.id);
      
      li.appendChild(textSpan);
      li.appendChild(delBtn);
      ul.appendChild(li);
    }

    function deleteHabit(id) {
      const habits = JSON.parse(localStorage.getItem(HABIT_STORAGE_KEY)) || [];
      const newHabits = habits.filter(h => h.id !== id);
      saveHabits(newHabits);
    }

    function filterHabits() {
      const query = document.getElementById("habitSearch").value.toLowerCase();
      const items = document.querySelectorAll("#habitList li");
      items.forEach(item => {
        const text = item.querySelector("span").textContent.toLowerCase();
        item.style.display = text.includes(query) ? "" : "none";
      });
    }

    // ---------------
    // Notes / Diary Logic
    // ---------------
    const NOTES_STORAGE_KEY = "notes";

    function loadNotes() {
      const notes = JSON.parse(localStorage.getItem(NOTES_STORAGE_KEY)) || [];
      const ul = document.getElementById("noteList");
      ul.innerHTML = "";
      notes.forEach(note => addNoteToDOM(note));
      updateStats();
    }

    function saveNotes(notes) {
      localStorage.setItem(NOTES_STORAGE_KEY, JSON.stringify(notes));
      updateStats();
    }

    function saveNote() {
      const textarea = document.getElementById("noteText");
      const text = textarea.value.trim();
      if (text === "") return;
      
      const note = {
        id: Date.now(),
        text: text,
        createdAt: new Date().toISOString()
      };
      
      addNoteToDOM(note);
      const notes = JSON.parse(localStorage.getItem(NOTES_STORAGE_KEY)) || [];
      notes.push(note);
      saveNotes(notes);
      textarea.value = "";
      textarea.focus();
      filterNotes();
    }

    function clearNote() {
      document.getElementById("noteText").value = "";
    }

    function addNoteToDOM(note) {
      const ul = document.getElementById("noteList");
      const li = document.createElement("li");
      li.dataset.id = note.id;
      
      const textSpan = document.createElement("span");
      textSpan.textContent = note.text;
      
      const delBtn = document.createElement("button");
      delBtn.innerHTML = "‚ùå";
      delBtn.title = "Delete note";
      delBtn.className = "secondary";
      delBtn.onclick = () => deleteNote(note.id);
      
      li.appendChild(textSpan);
      li.appendChild(delBtn);
      ul.appendChild(li);
    }

    function deleteNote(id) {
      const notes = JSON.parse(localStorage.getItem(NOTES_STORAGE_KEY)) || [];
      const newNotes = notes.filter(n => n.id !== id);
      saveNotes(newNotes);
    }

    function filterNotes() {
      const query = document.getElementById("noteSearch").value.toLowerCase();
      const items = document.querySelectorAll("#noteList li");
      items.forEach(item => {
        const text = item.querySelector("span").textContent.toLowerCase();
        item.style.display = text.includes(query) ? "" : "none";
      });
    }

    // Add Note with Ctrl+Enter (inside notes textarea)
    document.getElementById("noteText").addEventListener("keydown", function(event) {
      if (event.key === "Enter" && event.ctrlKey) {
        saveNote();
        event.preventDefault();
      }
    });

    // ---------------
    // Expense Tracker Logic
    // ---------------
    const EXPENSE_STORAGE_KEY = "expenses";

    function loadExpenses() {
      const expenses = JSON.parse(localStorage.getItem(EXPENSE_STORAGE_KEY)) || [];
      const ul = document.getElementById("expenseList");
      ul.innerHTML = "";
      expenses.forEach(expense => addExpenseToDOM(expense));
      updateStats();
    }

    function saveExpenses(expenses) {
      localStorage.setItem(EXPENSE_STORAGE_KEY, JSON.stringify(expenses));
      updateStats();
    }

    function addExpense() {
      const titleInput = document.getElementById("expenseTitle");
      const amountInput = document.getElementById("expenseAmount");
      const title = titleInput.value.trim();
      const amount = parseFloat(amountInput.value);

      if (title === "" || isNaN(amount) || amount <= 0) return;
      
      const expense = {
        id: Date.now(),
        title: title,
        amount: amount,
        createdAt: new Date().toISOString()
      };
      
      addExpenseToDOM(expense);
      const expenses = JSON.parse(localStorage.getItem(EXPENSE_STORAGE_KEY)) || [];
      expenses.push(expense);
      saveExpenses(expenses);
      titleInput.value = "";
      amountInput.value = "";
      titleInput.focus();
    }

    function addExpenseToDOM(expense) {
      const ul = document.getElementById("expenseList");
      const li = document.createElement("li");
      li.dataset.id = expense.id;
      
      const textSpan = document.createElement("span");
      textSpan.textContent = `${expense.title}: ‚Çπ${expense.amount.toFixed(2)}`;
      
      const delBtn = document.createElement("button");
      delBtn.innerHTML = "‚ùå";
      delBtn.title = "Delete expense";
      delBtn.className = "secondary";
      delBtn.onclick = () => deleteExpense(expense.id);
      
      li.appendChild(textSpan);
      li.appendChild(delBtn);
      ul.appendChild(li);
    }

    function deleteExpense(id) {
      const expenses = JSON.parse(localStorage.getItem(EXPENSE_STORAGE_KEY)) || [];
      const newExpenses = expenses.filter(e => e.id !== id);
      saveExpenses(newExpenses);
    }

    // Add Expense with Enter key on amount field
    document.getElementById("expenseAmount").addEventListener("keyup", function(event) {
      if (event.key === "Enter") addExpense();
    });

    // Search input debounce helper
    function debounce(func, delay) {
      let timeoutId;
      return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => func.apply(this, args), delay);
      };
    }

    // Wrap search filters with debounce
    const debouncedFilterTodos = debounce(filterTodos, 300);
    const debouncedFilterHabits = debounce(filterHabits, 300);
    const debouncedFilterNotes = debounce(filterNotes, 300);

    document.getElementById("todoSearch").addEventListener("input", debouncedFilterTodos);
    document.getElementById("habitSearch").addEventListener("input", debouncedFilterHabits);
    document.getElementById("noteSearch").addEventListener("input", debouncedFilterNotes);

    // ---------------
    // Floating Help Tooltip Logic
    // ---------------

    const helpToggleBtn = document.getElementById('helpToggle');
    const helpTooltip = document.getElementById('helpTooltip');
    const helpCloseBtn = document.getElementById('helpClose');

    helpToggleBtn.addEventListener('click', () => {
      helpTooltip.classList.toggle('hidden');
      if (!helpTooltip.classList.contains('hidden')) {
        helpTooltip.focus();
      }
    });

    helpCloseBtn.addEventListener('click', () => {
      helpTooltip.classList.add('hidden');
      helpToggleBtn.focus();
    });

    document.addEventListener('click', (e) => {
      if (!helpTooltip.contains(e.target) && e.target !== helpToggleBtn) {
        helpTooltip.classList.add('hidden');
      }
    });

    // Initialize everything
    loadTheme();
    updateStats();
  </script>
</body>
</html>
